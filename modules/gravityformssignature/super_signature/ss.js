function supports_canvas(){try{return document.createElement("canvas").getContext("2d"),!0}catch(t){return!1}}function getInternetExplorerVersion(){var t=-1;if("Microsoft Internet Explorer"==window.navigator.appName){var e=window.navigator.userAgent,r=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})");null!=r.exec(e)&&(t=parseFloat(RegExp.$1))}return t}function SuperSignature(){function MyAttachEvent(t,e,r){t.myEvents||(t.myEvents={}),t.myEvents[e]||(t.myEvents[e]=[]);var n=t.myEvents[e];n[n.length]=r}function MyFireEvent(t,e){if(t&&t.myEvents&&t.myEvents[e])for(var r=t.myEvents[e],n=0,i=r.length;i>n;n++)r[n]()}function ShowMessage(t){ShowDebug(t)}function LTrim(t){var e=/\s*((\S+\s*)*)/;return t.replace(e,"$1")}function RTrim(t){var e=/((\s*\S+)*)\s*/;return t.replace(e,"$1")}function ShowDebug(t){if(null!=currSignDebug&&"undefined"!=currSignDebug)try{currSignDebug.innerHTML=t+"...<br/>"+currSignDebug.innerHTML}catch(e){alert(e.description)}}function base64Encode(t){var e,r,n,i,o,s,u,h="",l=0;for(t=c(t);l<t.length;)e=t.charCodeAt(l++),r=t.charCodeAt(l++),n=t.charCodeAt(l++),i=e>>2,o=(3&e)<<4|r>>4,s=(15&r)<<2|n>>6,u=63&n,isNaN(r)?s=u=64:isNaN(n)&&(u=64),h=h+a.charAt(i)+a.charAt(o)+a.charAt(s)+a.charAt(u);return h}function b(t){for(var e="",r=0,n=c1=c2=0;r<t.length;)n=t.charCodeAt(r),128>n?(e+=String.fromCharCode(n),r++):n>191&&224>n?(c2=t.charCodeAt(r+1),e+=String.fromCharCode((31&n)<<6|63&c2),r+=2):(c2=t.charCodeAt(r+1),c3=t.charCodeAt(r+2),e+=String.fromCharCode((15&n)<<12|(63&c2)<<6|63&c3),r+=3);return e}function c(t){t=t.replace(/\x0d\x0a/g,"\n");for(var e="",r=0;r<t.length;r++){var n=t.charCodeAt(r);128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e}function base64Decode(t){var e,r,n,i,o,s="",u="",c="",h=0,l=a,g=/[^A-Za-z0-9\+\/\=]/g;g.exec(t),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");do n=l.indexOf(t.charAt(h++)),i=l.indexOf(t.charAt(h++)),o=l.indexOf(t.charAt(h++)),c=l.indexOf(t.charAt(h++)),e=n<<2|i>>4,r=(15&i)<<4|o>>2,u=(3&o)<<6|c,s+=String.fromCharCode(e),64!=o&&(s+=String.fromCharCode(r)),64!=c&&(s+=String.fromCharCode(u)),e=r=u="",n=i=o=c="";while(h<t.length);return unescape(s)}function SetSignData(){kData[0]=0;for(var t=1;t<kData.length;t++)kData[0]+=kData[t];isValid=kData[0]>=currReqPts?!0:!1,currTotalPts=kData[0];var e="";cData[0]=currVersion+","+currBackColor+","+currImgScale+","+currW+","+currH+","+currTrans+","+kData[0]+","+currID+";";for(var r=0;r<cData.length;r++)e+=cData[r];if(currSignData.value=cData.length>1?base64Encode(e):"",!isIE&&doBeizer){var n="";if(bData.length>0){for(var i=0;i<bData.length;i++){var o=bData[i];if(o.length)for(var e=0;e<o.length;e++)n+=o[e].x+" "+o[e].y+",";else n=n+o.x+" "+o.y+",";n+=";"}currSignDataSmooth.value=base64Encode(n);var a=document.getElementById(currID).toDataURL();currSignDataCanvas.value="data:,"==a?"":a}else currSignDataSmooth.value="",currSignDataCanvas.value=""}}function GetPointArray(t){var e=t;e.splice(0,1);for(var r=[],n=0;n<e.length;n++){var i=e[n].split(",");r.push({x:parseInt(i[0]),y:parseInt(i[1])})}return r}function ProcessCanvasArea(t){if(currentSignObj.clearRect(0,0,currW,currH),currBackUrl.length>0){var e=new Image;jQuery(e).bind("load",function(){}),e.src=currBackUrl}else SignatureBackColor(currID,currBackColor);for(var r=0;r<bData.length;r++){var n=bData[r],i=pData[r].split(","),o=i[0],a=i[1];if(n.length){currentSignObj.beginPath(),currentSignObj.lineWidth=o,currentSignObj.moveTo(n[0].x*t,n[0].y*t);for(var s=1;s<=n.length-3;s+=3)currentSignObj.bezierCurveTo(n[s].x*t,n[s].y*t,n[s+1].x*t,n[s+1].y*t,n[s+2].x*t,n[s+2].y*t),currentSignObj.strokeStyle=a,currentSignObj.stroke(),currentSignObj.beginPath(),currentSignObj.moveTo(n[s+2].x*t,n[s+2].y*t);currentSignObj.closePath()}else currentSignObj.beginPath(),currentSignObj.moveTo(n.x*t,n.y*t),currentSignObj.arc(n.x*t,n.y*t,o/2,0,2*Math.PI,!1),currentSignObj.strokeStyle=a,currentSignObj.fill(),currentSignObj.stroke(),currentSignObj.closePath()}}function findPos(t){var e=curtop=0;if(t.offsetParent)do e+=t.offsetLeft,curtop+=t.offsetTop;while(t=t.offsetParent);return[e,curtop]}function MarkStrokeEnd(){if(dataSaved=!0,mouseMoved=!1,fData.length>0&&(cData[pointCount]=" "+fData.join(" ")+";",!isIE&&doBeizer)){pData.push(fData[0]);var t=GetPointArray(fData);if(t.length>0){var e=new BezierCurves(t,30);bData.push(e),ProcessCanvasArea(1)}}SetSignData(),currSignStatus.innerHTML=kData[0]<currReqPts?currErrMsg:currSuccessMsg,isIE?currentSignObj.innerHTML=currentSignObj.innerHTML:(currentSignObj.closePath(),currentSignObj.restore()),iPhoneXPos=0,iPhoneYPos=0}function ReturnEvent(t){t.preventDefault&&t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.returnValue&&(t.returnValue=!1),t.preventManipulation&&t.preventManipulation()}this.SignObject="",this.PenSize=3,this.PenColor="#D24747",this.PenCursor="",this.ClearImage="",this.BorderWidth="2px",this.BorderStyle="dashed",this.BorderColor="#DCDCDC",this.BackColor="#ffffff",this.BackImageUrl="",this.SignzIndex="99",this.SignWidth=450,this.SignHeight=250,this.CssClass="",this.ApplyStyle=!0,this.SignToolbarBgColor="transparent",this.RequiredPoints=50,this.ErrorMessage="Please continue your signature.",this.StartMessage="Please sign",this.SuccessMessage="Signature OK.",this.ImageScaleFactor=.5,this.TransparentSign=!0,this.Enabled=!0,this.Visible=!0,this.Edition="Trial",this.IsCompatible=!1,this.InternalError="",this.LicenseKey="",this.IeModalFix=!1,this.SuccessFunction="",this.ErrorFunction="",this.ResetFunction="",this.SmoothSign=!0,this.jQueryEvent=!1,this.forceMouseEvent=!0;for(var n in arguments[0])this[n]=arguments[0][n];var pointCount=0,isIPhone=!1,currentSignObj=null,currentSignContainerObj=null,currSignStatus=null,currSignToolbar=null,currSignData=null,currSignDataSmooth=null,currSignDataCanvas=null,currSignDebug=null,enabled=this.Enabled,mouseMoved=!1,dataSaved=!1,cData=[],fData=[],kData=[],bData=[],pData=[],currVersion="1",dcMode=!1,currPenSize=this.PenSize,currPenColor=this.PenColor,currBackColor=this.BackColor,currBorderColor=this.BorderColor,currID=this.SignObject,currW=this.SignWidth,currH=this.SignHeight,currStartMsg=this.StartMessage,currErrMsg=this.ErrorMessage,currSuccessMsg=this.SuccessMessage,currSuccessFunction=this.SuccessFunction,currErrorFunction=this.ErrorFunction,currResetFunction=this.ResetFunction,currBackUrl=this.BackImageUrl,isValid=!1,currImgScale=this.ImageScaleFactor,currTrans=this.TransparentSign,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",currReqPts=this.RequiredPoints,currTotalPts=0,htm="",lastPositionX=0,lastPositionY=0,graphics,iPhoneXPos=0,iPhoneYPos=0,iemodalfix=this.IeModalFix,dotTime=null,iPhoneDotX=0,iPhoneDotY=0,doBeizer=this.SmoothSign,currjQE=this.jQueryEvent,currMouseForce=this.forceMouseEvent;if(isMobileIE)if(graphics=new jsGraphics(currID+"_Container"),null!=graphics&&"undefined"!=graphics)try{graphics.clear(),graphics.paint()}catch(ee){alert("Graphics object error "+ee.description)}else alert("Graphics object error");this.IsValid=function(){return isValid},this.CurrentTotalpoints=function(){return currTotalPts},this.ReturnFalse=function(t){t.preventManipulation&&t.preventManipulation(),t.preventDefault?t.preventDefault():t.returnValue=!1},this.XBrowserAddHandler=function(t,e,r){if(t.addEventListener)t.addEventListener(e,r,!1);else if(t.attachEvent)t.attachEvent("on"+e,r);else try{MyAttachEvent(t,e,r),t["on"+e]=function(){MyFireEvent(t,e)}}catch(n){alert("Event attaching exception, "+n.description)}},this.DisableSelection=function(){isIE||("undefined"!=typeof currentSignContainerObj.style.MozUserSelect?currentSignContainerObj.style.MozUserSelect="none":currentSignContainerObj.style.cursor="default")},this.ResizeSignature=function(t,e){if(currentSignContainerObj.style.width=t+"px",currentSignContainerObj.style.height=e+"px",currSignToolbar.style.width=t+"px",isIE)currentSignObj.style.width=t+"px",currentSignObj.style.height=e+"px";else{var r=document.getElementById(this.SignObject);r.width=parseInt(t,0),r.height=parseInt(e,0),r.style.width=t+"px",r.style.height=e+"px"}this.ResetClick(),this.SignWidth=t,this.SignHeight=e,currW=t,currH=e},this.SignatureColor=function(t){this.PenColor=t,currPenColor=t},this.SignatureBackColor=function(t){this.BackColor=t,currBackColor=t,isIE?currentSignObj.style.backgroundColor=t:(currentSignObj.fillStyle=t,currentSignObj.fillRect(0,0,currW,currH))},this.SignaturePen=function(t){this.PenSize=t,currPenSize=t},this.SignatureEnabled=function(t){this.Enabled=t,enabled=t},this.SignatureStatusBar=function(t){t?jQuery("#"+currSignToolbar.id).show("slow"):jQuery("#"+currSignToolbar.id).hide("slow")},this.UndoSignature=function(){if(cData.length<=2)return void this.ResetClick();cData.pop(),bData.pop(),kData.pop(),pData.pop(),SetSignData();var t=base64Decode("'"+currSignData.value+"'");this.LoadSignature(t,1)},this.LoadSignature=function(data,ratio){this.ResetClick(),(null==ratio||"undefined"==ratio)&&(ratio="1.0"),ratio=parseFloat(ratio);var cords=findPos(currentSignContainerObj),XPos=cords[0],YPos=cords[1],allStrokes=RTrim(LTrim(data)).split(";");cData[0]="";for(var i=0;i<allStrokes.length-1;i++)cData[i]=allStrokes[i]+";";for(var i=0;i<allStrokes.length-1;i++){var tmpArr=RTrim(LTrim(allStrokes[i])).split(" ");3==tmpArr.length&&tmpArr[2]==tmpArr[1]&&tmpArr.pop(),pData[i]=tmpArr[0],bData[i]=new BezierCurves(GetPointArray(tmpArr),30)}var allusefullData=allStrokes[0].split(",");currBackColor=allusefullData[1],currW=allusefullData[3],currH=allusefullData[4],currTrans=allusefullData[5],this.SignatureBackColor(currBackColor),kData[0]=0;for(var i=1,len=allStrokes.length;len-1>i;i++){var allCords=RTrim(LTrim(allStrokes[i])).split(" ");kData[i]=parseInt(allCords.length,0)-1,kData[0]=parseInt(kData[0],0)+parseInt(allCords.length,0);for(var j=0,lent=allCords.length;lent>j;j++){var twoVals=allCords[j].split(","),ptX=twoVals[0],ptY=twoVals[1];if(0==j)this.SignaturePen(ptX),this.SignatureColor(ptY),currentSignObj.strokeStyle=ptY,currentSignObj.lineWidth=ptX;else if(1==j){if(ptX=Math.abs(parseInt(ptX,0)*ratio),ptY=Math.abs(parseInt(ptY,0)*ratio),isIE)if(isMobileIE)lastPositionX=ptX,lastPositionY=ptY;else{var w='<SuperSignature:stroke weight="'+currPenSize+'" color="'+currPenColor+'" />',t='"m'+ptX+","+ptY+" l"+ptX+","+ptY,v='<SuperSignature:shape id="'+currID+"_l_"+(i-1)+'" style="position: absolute; left:0px; top:0px; width:'+currW+"px; height: "+currH+'px;" coordsize="'+currW+","+currH+'"><SuperSignature:path v='+t+' e" /><SuperSignature:fill on="false" />'+w+"</SuperSignature:shape>";currentSignObj.pathCoordString=t,currentSignObj.insertAdjacentHTML("beforeEnd",v)}else currentSignObj.beginPath(),currentSignObj.lineJoin="round",currentSignObj.lineCap="round",currentSignObj.moveTo(ptX,ptY);2==allCords.length&&eval("obj"+currID).DrawDot(ptX,ptY)}else if(ptX=Math.abs(parseInt(ptX,0)*ratio),ptY=Math.abs(parseInt(ptY,0)*ratio),isIE||doBeizer){currentSignObj.pathCoordString+=" "+ptX+","+ptY;var g=document.getElementById(currID+"_l_"+(i-1));if(g){var ic=g.firstChild;if(ic)try{ic.setAttribute("v",currentSignObj.pathCoordString+" e")}catch(je){var erxx=je.Description}}}else currentSignObj.strokeStyle=currPenColor,currentSignObj.lineWidth=currPenSize,currentSignObj.lineTo(ptX,ptY),currentSignObj.stroke(),currentSignObj.moveTo(ptX,ptY);isIE?currentSignObj.innerHTML=currentSignObj.innerHTML:(currentSignObj.closePath(),currentSignObj.restore())}pointCount++}!isIE&&doBeizer&&ProcessCanvasArea(ratio),SetSignData()},this.TextSignature=function(t,e,r,n){canvasSupport&&(currentSignObj.font=t,currentSignObj.fillText(e,r,n))},this.CheckCompatibility=function(){if(isIE)this.IsCompatible=!0,isMobileIE||document.namespaces.SuperSignature||document.namespaces.add("SuperSignature","urn:schemas-microsoft-com:vml","#default#VML");else{var t=!1;try{t=!!document.createElement("canvas").getContext("2d")}catch(e){t=!!document.createElement("canvas").getContext}t?(this.IsCompatible=!0,canvasSupport=!0):document.write("Your browser does not support our signature control.")}},this.MouseMove=function(t){if(enabled&&mouseMoved){"undefined"!=typeof t.originalEvent&&(t=t.originalEvent),ReturnEvent(t);var e=0,r=0,n=jQuery("#"+currentSignContainerObj.id).offset();if(isIPhone&&"undefined"!=typeof t.targetTouches){var i=t.targetTouches[0];e=i.pageX-iPhoneXPos,r=i.pageY-iPhoneYPos}else t.originalEvent?t.pageX?(e=parseInt(t.pageX-n.left),r=parseInt(t.pageY-n.top)):(e=parseInt(t.originalEvent.pageX-n.left),r=parseInt(t.originalEvent.pageY-n.top)):isIE||isIENine?(e=parseInt(t.x),r=parseInt(t.y),iever>=9&&(e=parseInt(t.pageX-n.left),r=parseInt(t.pageY-n.top))):(e=parseInt(t.pageX-n.left),r=parseInt(t.pageY-n.top));if(fData.push(isMobileIE?Math.abs(parseInt(e)-parseInt(currentSignContainerObj.offsetLeft))+","+Math.abs(parseInt(r)-parseInt(currentSignContainerObj.offsetTop)):Math.abs(parseInt(e))+","+Math.abs(parseInt(r))),kData[pointCount]++,isIE)if(isMobileIE){var o=e-lastPositionX,a=r-lastPositionY,s=o*o+a*a,u=64;if(s>u){if(null!=graphics&&"undefined"!=graphics)try{graphics.setStroke(currPenSize),graphics.setColor(currPenColor),graphics.drawLine(lastPositionX,lastPositionY,e,r),graphics.paint()}catch(c){ShowDebug("Drawing error: "+c.description)}else ShowDebug("Graphics object NULL");lastPositionX=e,lastPositionY=r}}else{currentSignObj.pathCoordString+=" "+e+","+r;var h=document.getElementById(currID+"_l_"+pointCount);if(h){var l=h.firstChild;if(l){try{l.setAttribute("v",currentSignObj.pathCoordString+" e")}catch(g){{g.Description}}dcMode&&kData[pointCount]%8==0&&(currentSignObj.innerHTML=currentSignObj.innerHTML)}}}else currentSignObj.lineTo(e,r),currentSignObj.stroke()}},this.DrawDot=function(t,e){if(kData[pointCount]++,isIE){var r='<SuperSignature:stroke weight="'+currPenSize+'" color="'+currPenColor+'" />',n='<SuperSignature:oval id="'+currID+"_l_"+pointCount+'" style="position: absolute; left:'+t+"px; top:"+e+"px; width:"+currPenSize+"px; height: "+currPenSize+'px;"">'+r+"</SuperSignature:oval>";currentSignObj.insertAdjacentHTML("beforeEnd",n)}else currentSignObj.arc(t,e,currPenSize/2,0,2*Math.PI,!1),currentSignObj.fill(),currentSignObj.stroke()},this.MouseOut=function(){enabled&&(ShowDebug("Mouse out"),dataSaved||MarkStrokeEnd())},this.MouseUp=function(e){if(enabled){if(ShowDebug("Mouse up"),null!=dotTime){var td=parseInt(new Date-dotTime);if(125>td){var ptX=0,ptY=0;if(ShowDebug("Time diff "+td),isIPhone)ptX=iPhoneDotX,ptY=iPhoneDotY;else{var mOffSet=jQuery("#"+currentSignContainerObj.id).offset();e.originalEvent?e.pageX?(ptX=parseInt(e.pageX-mOffSet.left),ptY=parseInt(e.pageY-mOffSet.top)):(ptX=parseInt(e.originalEvent.pageX-mOffSet.left),ptY=parseInt(e.originalEvent.pageY-mOffSet.top)):isIE||isIENine?(ptX=parseInt(e.x),ptY=parseInt(e.y)):(ptX=parseInt(e.pageX-mOffSet.left),ptY=parseInt(e.pageY-mOffSet.top))}isIE&&(ShowDebug("Drawing Dot At ("+ptX+","+ptY+")"),eval("obj"+currID).DrawDot(ptX,ptY))}dotTime=null}dataSaved||MarkStrokeEnd()}},this.MouseDown=function(t){if(ShowDebug("Mouse down called"),!enabled)return void ShowDebug("Control is disabled");"undefined"!=typeof t.originalEvent&&(ShowDebug("jQuery event replaced"),t=t.originalEvent),ReturnEvent(t),ShowDebug("Mouse down"),dotTime=new Date,mouseMoved=!0,dataSaved=!1;var e,r;if(isIPhone&&"undefined"!=typeof t.targetTouches){var n=t.targetTouches[0];if(0==iPhoneXPos){var i=findPos(currentSignContainerObj);iPhoneXPos=i[0],iPhoneYPos=i[1]}e=n.pageX-iPhoneXPos,r=n.pageY-iPhoneYPos,iPhoneDotX=e,iPhoneDotY=r}else{var o=jQuery("#"+currentSignContainerObj.id).offset();t.originalEvent?t.pageX?(e=parseInt(t.pageX-o.left),r=parseInt(t.pageY-o.top)):(e=parseInt(t.originalEvent.pageX-o.left),r=parseInt(t.originalEvent.pageY-o.top)):isIE||isIENine?9>iever?(e=parseInt(t.x),r=parseInt(t.y)):isIENine&&(e=parseInt(t.pageX)-parseInt(o.left)+parseInt(jQuery("html").css("margin-left")),r=parseInt(t.pageY)-parseInt(o.top)+parseInt(jQuery("html").css("margin-top")),iever>=10&&(e=parseInt(t.pageX-o.left),r=parseInt(t.pageY-o.top))):(e=parseInt(t.pageX-o.left),r=parseInt(t.pageY-o.top))}if(ShowDebug("Down ("+e+","+r+")"),pointCount++,kData[pointCount]=0,fData.length=0,fData[0]=currPenSize+","+currPenColor,fData.push(isMobileIE?Math.abs(parseInt(e)-parseInt(currentSignContainerObj.offsetLeft))+","+Math.abs(parseInt(r)-parseInt(currentSignContainerObj.offsetTop)):Math.abs(parseInt(e))+","+Math.abs(parseInt(r))),isIE)if(isMobileIE)lastPositionX=e,lastPositionY=r;else{var a='<SuperSignature:stroke weight="'+currPenSize+'" color="'+currPenColor+'" />',s='"m'+e+","+r+" l"+e+","+r,u='<SuperSignature:shape id="'+currID+"_l_"+pointCount+'" style="position: absolute; left:0px; top:0px; width:'+currW+"px; height: "+currH+'px;" coordsize="'+currW+","+currH+'"><SuperSignature:path v='+s+' e" /><SuperSignature:fill on="false" />'+a+"</SuperSignature:shape>";currentSignObj.pathCoordString=s,currentSignObj.insertAdjacentHTML("beforeEnd",u)}else currentSignObj.save(),currentSignObj.beginPath(),currentSignObj.lineJoin="round",currentSignObj.lineCap="round",currentSignObj.strokeStyle=currPenColor,currentSignObj.lineWidth=currPenSize,currentSignObj.moveTo(e,r);return!1},this.ResetClick=function(){if(enabled){if(isMobileIE||(document.getElementById(currID).style.borderColor=currBorderColor),isIE)currentSignObj.innerHTML="",isMobileIE&&(lastPositionX=0,lastPositionY=0,null!=graphics&&"undefined"!=graphics&&(graphics.clear(),graphics.paint()));else if(currentSignObj.clearRect(0,0,currW,currH),currBackUrl.length>0)if(isIE)currentSignObj.style.backgroundImage='url("'+currBackUrl+'")';else{var t=new Image;jQuery(t).bind("load",function(){currentSignObj.drawImage(this,0,0)}),t.src=currBackUrl}else SignatureBackColor(currID,currBackColor);cData=[],fData=[],kData=[],bData=[],pData=[],SetSignData(),pointCount=0,htm="",currSignStatus.innerHTML=currStartMsg}},this.Init=function(){if(!this.Visible)return void ShowDebug("Control hidden");if(this.CheckCompatibility(),this.IsCompatible){if(canvasSupport){if("DIV"==document.getElementById(this.SignObject).nodeName.toUpperCase()){var t="<canvas ID='"+this.SignObject+"' width='"+currW+"' height='"+currH+"' style='left:0px;top:0px;position:absolute;'></canvas>";jQuery("#"+this.SignObject).replaceWith(t),ShowDebug("DIV changed to CANVAS"),isIE=!1}}else if("CANVAS"==document.getElementById(this.SignObject).nodeName.toUpperCase()){var e="<div ID='"+this.SignObject+"' style='width:"+currW+"px;height:"+currH+"px;left:0px;top:0px;'></div>";jQuery("#"+this.SignObject).replaceWith(e),ShowDebug("CANVAS changed to DIV"),isIE=!0}if(currSignDebug=document.getElementById(this.SignObject+"_Debug"),currentSignObj=document.getElementById(this.SignObject),currentSignContainerObj=document.getElementById(this.SignObject+"_Container"),currentSignObj.addEventListener)ShowDebug("addEventListener supported");else{if(!currentSignObj.attachEvent)return void ShowDebug("Mouse events are not supported");ShowDebug("attachEvent supported")}if(this.mouseMoved=!1,null!=currentSignObj&&"undefined"!=currentSignObj){if(ShowDebug("Objects OK"),isIE&&!isMobileIE&&(dcMode=document.documentMode?document.documentMode>=8:!1),isMobileIE&&ShowDebug("Mobile IE"),isIENine&&ShowDebug("IE 9 Or Above"),isOperaMini&&ShowDebug("Opera Mini, not supported."),kData[0]=0,cData[0]=currVersion+","+currBackColor+","+currImgScale+","+currW+","+currH+","+currTrans+","+kData[0]+","+currID+";",this.ApplyStyle){ShowDebug("Setting up style");try{isMobileIE?(currentSignContainerObj.style.borderWidth=this.BorderWidth,currentSignContainerObj.style.borderStyle=this.BorderStyle,currentSignContainerObj.style.borderColor=this.BorderColor,currentSignContainerObj.style.backgroundColor=this.BackColor,currentSignContainerObj.style.zIndex=this.SignzIndex,this.PenCursor.length>0&&(currentSignContainerObj.style.cursor="url('"+this.PenCursor+"'), pointer"),this.BackImageUrl.length>0&&(currentSignContainerObj.style.backgroundImage='url("'+this.BackImageUrl+'")')):(currentSignObj.style.borderWidth=this.BorderWidth,currentSignObj.style.borderStyle=this.BorderStyle,currentSignObj.style.borderColor=this.BorderColor,currentSignObj.style.backgroundColor=this.BackColor,currentSignObj.style.zIndex=this.SignzIndex,this.PenCursor.length>0&&(currentSignObj.style.cursor="url('"+this.PenCursor+"'), pointer"),this.BackImageUrl.length>0&&(currentSignObj.style.backgroundImage='url("'+this.BackImageUrl+'")'),""!=this.CssClass&&(currentSignObj.className=this.CssClass),currentSignObj.style.width=this.SignWidth+"px",currentSignObj.style.height=this.SignHeight+"px","auto"==currentSignObj.style.cursor&&(currentSignObj.style.cursor="url('"+this.PenCursor+"'), hand")),ShowDebug("Style OK")}catch(r){ShowDebug("Style Error : "+r.description)}}var n='<div id="'+this.SignObject+'_toolbar" style="margin:5px;position:relative;height:20px;width:'+this.SignWidth+"px;background-color:"+this.SignToolbarBgColor+';"><img  id="'+this.SignObject+'_resetbutton" src="'+this.ClearImage+'" style="cursor:pointer;float:right;height:24px;width:24px;border:0px solid transparent" alt="Clear Signature" />';n+='<div id="'+this.SignObject+'_status" style="color:blue;height:20px;width:auto;padding:2px;font-family:verdana;font-size:12px;float:left;margin-right:30px;">'+this.StartMessage+"</div>",n+=null==document.getElementById(this.SignObject+"_data")?'<input type="hidden" id="'+this.SignObject+'_data" name="'+this.SignObject+'_data" value="">':"",n+=null==document.getElementById(this.SignObject+"_data_smooth")?'<input type="hidden" id="'+this.SignObject+'_data_smooth" name="'+this.SignObject+'_data_smooth" value="">':"",n+=null==document.getElementById(this.SignObject+"_data_canvas")?'<input type="hidden" id="'+this.SignObject+'_data_canvas" name="'+this.SignObject+'_data_canvas" value="">':"",n+="</div>",ShowDebug("Setting up tools"),jQuery("#"+currentSignContainerObj.id).after(n),pointCount=0;var i="mousedown",o="mouseup",a="mousemove",s="mouseout";isIE&&(s="mouseleave"),isIPhone=new RegExp("iPhone","i").test(navigator.userAgent)||new RegExp("iPad","i").test(navigator.userAgent)||new RegExp("Android","i").test(navigator.userAgent)||new RegExp("playbook","i").test(navigator.userAgent)||new RegExp("symbian","i").test(navigator.userAgent),isIPhone||isIE||(isIPhone="ontouchstart"in window,ShowDebug("Touch check "+isIPhone)),isIPhone&&(ShowDebug("Found iPhone, iPad, Android or Touch Screen Device"),i="touchstart",o="touchend",a="touchmove"),isIETablet&&ShowDebug("Found Tablet 2.0 or Windows Phone or Touch Screen Device"),winTabletPointerEvt?(ShowDebug("MSPointer supported"),i="MSPointerDown",o="MSPointerUp",a="MSPointerMove",s="MSPointerOut"):ShowDebug("MSPointer NOT supported"),"undefined"!=typeof currentSignObj.style.msTouchAction&&(currentSignObj.style.msTouchAction="none",jQuery("#"+currentSignObj.id).css("-ms-touch-action","none"),ShowDebug("MS Touch CSS added")),"undefined"!=typeof currentSignContainerObj.style.msTouchAction&&(currentSignContainerObj.style.msTouchAction="none",jQuery("#"+currentSignContainerObj.id).css("-ms-touch-action","none")),isIE||(currentSignObj=document.getElementById(this.SignObject).getContext("2d"),currentSignObj.width=this.SignWidth,currentSignObj.height=this.SignHeight),currSignStatus=document.getElementById(this.SignObject+"_status"),currSignStatus.innerHTML=currStartMsg,currSignToolbar=document.getElementById(this.SignObject+"_toolbar"),currSignData=document.getElementById(this.SignObject+"_data"),currSignDataSmooth=document.getElementById(this.SignObject+"_data_smooth"),currSignDataCanvas=document.getElementById(this.SignObject+"_data_canvas");var u=document.getElementById(this.SignObject+"_resetbutton");null!=u&&this.XBrowserAddHandler(u,"click",this.ResetClick),ShowDebug("Attaching events"),this.XBrowserAddHandler(currentSignContainerObj,"contextmenu",this.ReturnFalse),this.XBrowserAddHandler(currentSignContainerObj,"selectstart",this.ReturnFalse),this.XBrowserAddHandler(currentSignContainerObj,"dragstart",this.ReturnFalse),this.XBrowserAddHandler(currentSignObj,"contextmenu",this.ReturnFalse),this.XBrowserAddHandler(currentSignObj,"selectstart",this.ReturnFalse),this.XBrowserAddHandler(currentSignObj,"dragstart",this.ReturnFalse),this.DisableSelection(),this.IeModalFix&&ShowDebug("IeModalFix true"),!this.IeModalFix||isIPhone||isIETablet?isIE&&!isMobileIE?(this.XBrowserAddHandler(currentSignObj,i,this.MouseDown),this.XBrowserAddHandler(currentSignObj,o,this.MouseUp),this.XBrowserAddHandler(currentSignObj,a,this.MouseMove),this.XBrowserAddHandler(currentSignObj,s,this.MouseOut)):(this.XBrowserAddHandler(currentSignContainerObj,i,this.MouseDown),this.XBrowserAddHandler(currentSignContainerObj,o,this.MouseUp),this.XBrowserAddHandler(currentSignContainerObj,a,this.MouseMove),this.XBrowserAddHandler(currentSignContainerObj,s,this.MouseOut),this.XBrowserAddHandler(currentSignObj,s,this.MouseOut)):(jQuery(currentSignContainerObj).bind(i,this.MouseDown),jQuery(currentSignContainerObj).bind(o,this.MouseUp),jQuery(currentSignContainerObj).bind(a,this.MouseMove),jQuery(currentSignContainerObj).bind(s,this.MouseOut),ShowDebug("ModalFix event attached")),currjQE&&(ShowDebug("Attaching jQuery Events"),jQuery(currentSignContainerObj).bind(i,this.MouseDown),jQuery(currentSignContainerObj).bind(o,this.MouseUp),jQuery(currentSignContainerObj).bind(a,this.MouseMove),isIPhone||jQuery(currentSignContainerObj).bind(s,this.MouseOut)),currMouseForce&&(i="mousedown",o="mouseup",a="mousemove",ShowDebug("Attaching Mouse Events - Forced"),this.XBrowserAddHandler(currentSignContainerObj,i,this.MouseDown),this.XBrowserAddHandler(currentSignContainerObj,o,this.MouseUp),this.XBrowserAddHandler(currentSignContainerObj,a,this.MouseMove),currjQE&&(jQuery(currentSignContainerObj).bind(i,this.MouseDown),jQuery(currentSignContainerObj).bind(o,this.MouseUp),jQuery(currentSignContainerObj).bind(a,this.MouseMove))),ShowDebug("isIE "+isIE),ShowDebug("isIE 9+ "+isIENine),(isIE||isIENine||isIETablet)&&ShowDebug("IE Ver - "+iever),supports_canvas()&&ShowDebug("Canvas - Yes"),enabled||ShowDebug("Control is disabled"),ShowDebug("Ready")}else ShowDebug("Error initializing signature control")}}}ValidateSignature=function(id){var result=!0;if(null==id||"undefined"==id||""==id)for(var i=0;i<signObjects.length;i++){var cid=signObjects[i],isitOk=eval("obj"+cid).IsValid();isitOk||(result=!1,isMobileIE||(document.getElementById(cid).style.borderColor="red"))}else result=eval("obj"+id).IsValid(),isMobileIE||0!=result||(document.getElementById(id).style.borderColor="red");return result},ClearSignature=function(id){if(null==id||"undefined"==id||""==id)for(var i=0;i<signObjects.length;i++){var id=signObjects[i];eval("obj"+id).ResetClick()}else eval("obj"+id).ResetClick()},ResizeSignature=function(id,w,h){eval("obj"+id).ResizeSignature(w,h)},SignatureColor=function(id,color){eval("obj"+id).SignatureColor(color)},SignatureBackColor=function(id,color){eval("obj"+id).SignatureBackColor(color)},SignaturePen=function(id,size){eval("obj"+id).SignaturePen(size)},SignatureEnabled=function(id,enable){eval("obj"+id).SignatureEnabled(enable)},SignatureStatusBar=function(id,show){eval("obj"+id).SignatureStatusBar(show)},SignatureTotalPoints=function(id){return eval("obj"+id).CurrentTotalpoints()},UndoSignature=function(id){eval("obj"+id).UndoSignature()},LoadSignature=function(id,data){eval("obj"+id).LoadSignature(data)},TextSignature=function(id,font,text,x,y){eval("obj"+id).TextSignature(font,text,x,y)};var msie=window.navigator.userAgent.toUpperCase().indexOf("MSIE "),isIE=!1,isIENine=!1,isIETen=!1,isMobileIE=!1,isOperaMini=!1,isIETablet=!1,winTabletPointerEvt=!1,iever=getInternetExplorerVersion(),canvasSupport=!1;window.navigator.userAgent.toUpperCase().indexOf("OPERA MINI")>0&&(isOperaMini=!0),window.navigator.userAgent.toUpperCase().indexOf("OPERA MOBI")>0&&(isOperaMini=!0),msie>0&&(isIE=!0,supports_canvas()&&(isIE=!1,iever>=9&&(isIENine=!0)),window.navigator.userAgent.toUpperCase().indexOf("IEMOBILE ")>0&&(isMobileIE=!0)),isIETablet=new RegExp("Tablet PC","i").test(window.navigator.userAgent),winTabletPointerEvt=window.navigator.msPointerEnabled,isIETablet||(window.navigator.userAgent.toUpperCase().indexOf("WINDOWS PHONE ")>0&&(isIETablet=!0),window.navigator.msMaxTouchPoints&&(isIETablet=!0)),BezierCurves=function(t,e){if(t.length<2)return t[0];var r,n;this.points=[];for(var i=0;i<t.length;i++)r=new Smooth(t[i].x,t[i].y),r.CheckValid(n)||this.points.push(r),n=r,this.offSet=0,this.error=e,this.result=[],this.result.push({x:t[0].x,y:t[0].y+this.offSet});return this.fit()},BezierCurves.prototype={fit:function(){return this.processFitPoints(0,this.points.length-1,this.points[1].MathFunc2(this.points[0]).nOR(),this.points[this.points.length-2].MathFunc2(this.points[this.points.length-1]).nOR()),this.result},processFitPoints:function(t,e,r,n){var i,o,a,s,u,c;if(e-t==1){var h=this.points[t],l=this.points[e],g=h.MathFunc6(l)/3;return void this.savePoints([h,h.MathFunc1(r.nOR(g)),l.MathFunc1(n.nOR(g)),l])}for(i=this.cLP(t,e),o=Math.max(this.error,this.error*this.error),s=0;4>=s;s++){if(u=this.gB(t,e,i,r,n),c=this.fM(t,e,u,i),c.error<this.error)return void this.savePoints(u);if(a=c.index,c.error>=o)break;this.rP(t,e,i,u),o=c.error}var d=this.points[a-1].MathFunc2(this.points[a]),S=this.points[a].MathFunc2(this.points[a+1]),p=d.MathFunc1(S).MathFunc4(2).nOR();this.processFitPoints(t,a,r,p),this.processFitPoints(a,e,p.MathFunc5(),n)},savePoints:function(t){this.result.push({x:this.r2(t[1].x),y:this.r2(t[1].y+this.offSet)}),this.result.push({x:this.r2(t[2].x),y:this.r2(t[2].y+this.offSet)}),this.result.push({x:this.r2(t[3].x),y:this.r2(t[3].y+this.offSet)})},r2:function(t){return Math.round(100*t)/100},gB:function(t,e,r,n,i){for(var o,a,s,u,c,h,l,g,d=1e-11,S=this.points[t],p=this.points[e],b=[[0,0],[0,0]],f=[0,0],v=0,j=e-t+1;j>v;v++){var C=r[v],O=1-C,I=3*C*O,m=O*O*O,y=I*O,M=I*C,D=C*C*C,E=n.nOR(y),w=i.nOR(M),P=this.points[t+v].MathFunc2(S.MathFunc3(m+y)).MathFunc2(p.MathFunc3(M+D));b[0][0]+=E.dot(E),b[0][1]+=E.dot(w),b[1][0]=b[0][1],b[1][1]+=w.dot(w),f[0]+=E.dot(P),f[1]+=w.dot(P)}return o=b[0][0]*b[1][1]-b[1][0]*b[0][1],Math.abs(o)>d?(u=b[0][0]*f[1]-b[1][0]*f[0],c=f[0]*b[1][1]-f[1]*b[0][1],a=c/o,s=u/o):(h=b[0][0]+b[0][1],l=b[1][0]+b[1][1],a=s=Math.abs(h)>d?f[0]/h:Math.abs(h)>d?f[1]/l:0),g=p.MathFunc6(S),d*=g,(d>a||d>s)&&(a=s=g/3),[S,S.MathFunc1(n.nOR(a)),p.MathFunc1(i.nOR(s)),p]},rP:function(t,e,r,n){for(var i=t;e>=i;i++)r[i-t]=this.fR(n,this.points[i],r[i-t])},fR:function(t,e,r){for(var n=[],i=[],o=0;2>=o;o++)n[o]=t[o+1].MathFunc2(t[o]).MathFunc3(3);for(o=0;1>=o;o++)i[o]=n[o+1].MathFunc2(n[o]).MathFunc3(2);var a=this.eV(3,t,r),s=this.eV(2,n,r),u=this.eV(1,i,r),c=a.MathFunc2(e),h=s.dot(s)+c.dot(u);return Math.abs(h)<1e-5?r:r-c.dot(s)/h},eV:function(t,e,r){for(var n,i=e.slice(),o=1;t>=o;o++)for(n=0;t-o>=n;n++)i[n]=i[n].MathFunc3(1-r).MathFunc1(i[n+1].MathFunc3(r));return i[0]},cLP:function(t,e){for(var r,n=[0],i=t+1;e>=i;i++)n[i-t]=n[i-t-1]+this.points[i].MathFunc6(this.points[i-1]);for(i=1,r=e-t;r>=i;i++)n[i]/=n[r];return n},fM:function(t,e,r,n){for(var i=Math.floor((e-t+1)/2),o=0,a=t+1;e>a;a++){var s=this.eV(3,r,n[a-t]),u=s.MathFunc2(this.points[a]),c=u.x*u.x+u.y*u.y;c>=o&&(o=c,i=a)}return{error:o,index:i}}},Smooth=function(t,e){this.x=t,this.y=e},Smooth.prototype={CheckPtArray:function(t){return"number"==typeof t?{x:t,y:t}:t},MathFunc1:function(t){return t=this.CheckPtArray(t),SmoothRet(this.x+t.x,this.y+t.y)},MathFunc2:function(t){return t=this.CheckPtArray(t),SmoothRet(this.x-t.x,this.y-t.y)},MathFunc3:function(t){return t=this.CheckPtArray(t),SmoothRet(this.x*t.x,this.y*t.y)},MathFunc4:function(t){return t=this.CheckPtArray(t),SmoothRet(this.x/t.x,this.y/t.y)},MathFunc5:function(){return SmoothRet(-this.x,-this.y)},MathFunc6:function(t,e){var r=t.x-this.x,n=t.y-this.y,i=r*r+n*n;return e?i:Math.sqrt(i)},getLength:function(){var t=this.x*this.x+this.y*this.y;
	return arguments[0]?t:Math.sqrt(t)},nOR:function(t){void 0===t&&(t=1);var e=this.getLength(),r=0!=e?t/e:0;return SmoothRet(this.x*r,this.y*r)},CheckValid:function(t){return null==t?!1:this.x==t.x&&this.y==t.y},dot:function(t){return this.x*t.x+this.y*t.y}};var SmoothRet=function(t,e){return new Smooth(t,e)};Compress=function(t,e){var r,n,i,o,a=0,s=0,u=t.length,c="";for(e=Math.pow(10,e),o=0;u>o;o++)r=Math.round(t[o].y*e),n=Math.round(t[o].x*e),c+=EncodeStr(r-a),c+=EncodeStr(n-s),a=r,s=n;for(i=[["?","0"],["@","1"],["[","2"],["\\","3"],["]","4"],["^","5"],["`","6"],["{","7"],["|","8"],["}","9"]],o=0;o<i.length;o++)c=c.replaceAll(i[o][0],i[o][1]);return c},EncodeStr=function(t){var e,t=t<<1;for(0>t&&(t=~t),e="";t>=32;)e+=String.fromCharCode((32|31&t)+63),t>>=5;return e+String.fromCharCode(t+63)},String.prototype.replaceAll=function(t,e,r){return this.replace(new RegExp(t.replace(/([\/\,\!\\\^\$\{\}\[\]\(\)\.\*\+\?\|\<\>\-\&])/g,"\\$&"),r?"gi":"g"),"string"==typeof e?e.replace(/\$/g,"$$$$"):e)};